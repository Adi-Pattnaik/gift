<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Letter for You üíå</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #ffe6f0, #fff0f6, #ffffff);
        font-family: "Dancing Script", cursive;
        overflow: hidden;
      }

      .letter-container {
        background: rgba(255, 255, 255, 0.85);
        border-radius: 20px;
        padding: 40px;
        max-width: 600px;
        box-shadow: 0 10px 40px rgba(214, 51, 132, 0.3);
        text-align: left;
        font-size: 1.5rem;
        line-height: 1.8;
        color: #c21760;
        position: relative;
        z-index: 10;
        animation: fadeIn 2s ease;
      }

      .letter-container h1 {
        text-align: center;
        font-size: 2.2rem;
        margin-bottom: 20px;
        color: #d63384;
      }

      .typewriter {
        border-right: 2px solid #d63384;
        white-space: pre-wrap;
        overflow: hidden;
        animation: blinkCursor 0.7s infinite;
      }

      @keyframes blinkCursor {
        0%,
        100% {
          border-color: transparent;
        }
        50% {
          border-color: #d63384;
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Floating hearts */
      .heart {
        position: fixed;
        top: -10px;
        font-size: 20px;
        color: #ff69b4;
        animation: fall linear forwards;
        pointer-events: none;
        opacity: 0.8;
        z-index: 5;
      }

      @keyframes fall {
        0% {
          transform: translateY(-10px) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(110vh) rotate(360deg);
          opacity: 0;
        }
      }

      /* Button */
      .end-btn {
        display: block;
        margin: 30px auto 0;
        padding: 12px 25px;
        background: #d63384;
        color: white;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        font-size: 1rem;
        font-family: "Poppins", sans-serif;
        box-shadow: 0 6px 20px rgba(214, 51, 132, 0.3);
        transition: 0.3s;
        z-index: 10;
        position: relative;
      }
      .end-btn:hover {
        background: #c21760;
        box-shadow: 0 8px 30px rgba(214, 51, 132, 0.5);
        transform: translateY(-2px);
      }

      /* Fireworks canvas */
      #fireworks {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 20;
      }

      #finalMessage {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 100px;
  font-weight: bold;
  color: #ff1493;
  text-shadow: 0 0 20px #ff69b4, 0 0 40px #ff69b4;
  display: none;
  animation: pulse 1s ease-in-out 3; /* glow & pulse 3 times */
  z-index: 30;
}

@keyframes pulse {
  0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.8; }
}

/* Blur effect */
.blurred {
  filter: blur(8px);
  transition: filter 1s ease;
}


      @keyframes pulse {
        0% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 1;
        }
        50% {
          transform: translate(-50%, -50%) scale(1.1);
          opacity: 0.85;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="letter-container">
      <h1>My Dearest üíï</h1>
      <p class="typewriter" id="letterText"></p>
      <button class="end-btn" id="surpriseBtn">Forever Together</button>
    </div>

    <canvas id="fireworks"></canvas>
    <div id="finalMessage">I ‚ù§Ô∏è YOU</div>

    <script>
      // Typewriter
      const text = `From the very first day, you‚Äôve been my favorite person üå∏
Every smile of yours is my sunshine ‚òÄÔ∏è
Every laugh, my favorite melody üé∂
And every little moment with you... my universe üí´

I‚Äôm so grateful for YOU üíñ
And I‚Äôll always be here ‚Äî today, tomorrow, forever. üíï`;

      let index = 0;
      const speed = 50;
      const letterEl = document.getElementById("letterText");

      function typeWriter() {
        if (index < text.length) {
          letterEl.innerHTML += text.charAt(index);
          index++;
          setTimeout(typeWriter, speed);
        }
      }
      window.onload = typeWriter;

      // Floating hearts
      function createHeart() {
        const heart = document.createElement("div");
        heart.className = "heart";
        heart.textContent = ["üíñ", "üíï", "üíó", "üíì", "üíû"][
          Math.floor(Math.random() * 5)
        ];
        heart.style.left = Math.random() * 100 + "vw";
        heart.style.animationDuration = 3 + Math.random() * 5 + "s";
        heart.style.fontSize = 16 + Math.random() * 20 + "px";
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 8000);
      }
      setInterval(createHeart, 300);

      // Fireworks
      const canvas = document.getElementById("fireworks");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      class Particle {
        constructor(x, y, dx, dy, color) {
          this.x = x;
          this.y = y;
          this.dx = dx;
          this.dy = dy;
          this.color = color;
          this.life = 100;
        }
        update() {
          this.x += this.dx;
          this.y += this.dy;
          this.dy += 0.05;
          this.life--;
        }
        draw() {
          if (this.life > 0) {
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
            ctx.fill();
          }
        }
      }

      class Firework {
        constructor(x, y, colors) {
          this.particles = [];
          for (let i = 0; i < 100; i++) {
            const angle = Math.random() * 2 * Math.PI;
            const speed = Math.random() * 5 + 2;
            this.particles.push(
              new Particle(
                x,
                y,
                Math.cos(angle) * speed,
                Math.sin(angle) * speed,
                colors[Math.floor(Math.random() * colors.length)]
              )
            );
          }
        }
        update() {
          this.particles.forEach((p) => p.update());
        }
        draw() {
          this.particles.forEach((p) => p.draw());
        }
      }

      let fireworks = [];
      let interval;

      function animate() {
        requestAnimationFrame(animate);
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        fireworks.forEach((fw, i) => {
          fw.update();
          fw.draw();
          if (fw.particles.every((p) => p.life <= 0)) fireworks.splice(i, 1);
        });
      }
      animate();

      function launchFireworks() {
        const colors = ["#ff69b4", "#ffd700", "#ff4500", "#00ffcc", "#ff1493"];
        fireworks.push(
          new Firework(
            Math.random() * canvas.width,
            (Math.random() * canvas.height) / 2,
            colors
          )
        );
      }

      document.getElementById("surpriseBtn").addEventListener("click", () => {
  // blur letter background
  document.querySelector(".letter-container").classList.add("blurred");

  interval = setInterval(launchFireworks, 800);

  // after 5s stop fireworks and show glowing text
  setTimeout(() => {
    clearInterval(interval);
    fireworks = [];
    const msg = document.getElementById("finalMessage");
    msg.style.display = "block";

    // after pulse ends -> explode text into fireworks
    msg.addEventListener("animationend", () => {
      msg.style.display = "none";
      textBurst("I ‚ù§Ô∏è YOU");
      // unblur background after 2s
      setTimeout(() => {
        document.querySelector(".letter-container").classList.remove("blurred");
      }, 2000);
    }, { once: true });
  }, 5000);
});

// Pixel burst using canvas text
function textBurst(message) {
  const tempCanvas = document.createElement("canvas");
  const tctx = tempCanvas.getContext("2d");
  tempCanvas.width = canvas.width;
  tempCanvas.height = canvas.height;

  // draw message onto temp canvas
  tctx.font = "bold 120px Arial";
  tctx.fillStyle = "white";
  tctx.textAlign = "center";
  tctx.fillText(message, canvas.width / 2, canvas.height / 2);

  const imageData = tctx.getImageData(0, 0, canvas.width, canvas.height).data;
  const colors = ["#ff69b4", "#ffd700", "#ff4500", "#00ffcc", "#ff1493"];

  for (let y = 0; y < canvas.height; y += 8) {
    for (let x = 0; x < canvas.width; x += 8) {
      const alpha = imageData[(y * canvas.width + x) * 4 + 3];
      if (alpha > 128) {
        const angle = Math.random() * 2 * Math.PI;
        const speed = Math.random() * 6 + 2;
        fireworks.push({
          particles: [
            new Particle(
              x,
              y,
              Math.cos(angle) * speed,
              Math.sin(angle) * speed,
              colors[Math.floor(Math.random() * colors.length)]
            )
          ]
        });
      }
    }
  }
}


      // Resize
      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });
    </script>
  </body>
</html>
